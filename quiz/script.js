const fillingGame = [
  [
    {
      name: 'Король лев',
      description:
        'Американский мультипликационный музыкальный драматический фильм 1994 года производства выпущенный компанией Walt Disney Pictures.',
      image: 'assets/1/1.png',
      audio: 'assets/1/1.mp3',
    },
    {
      name: 'Простоквашино',
      description:
        'Советский рисованный мультфильм 1978 года, поставленный режиссёром Владимиром Поповым по мотивам повести Эдуарда Успенского.',
      image: 'assets/1/2.png',
      audio: 'assets/1/2.mp3',
    },
    {
      name: 'Смешарики',
      description:
        'Российский анимационный сериал, созданный Анатолием Прохоровым, Ильёй Поповым и Салаватом Шайхинуровым.',
      image: 'assets/1/3.png',
      audio: 'assets/1/3.mp3',
    },
    {
      name: 'Утиные истории',
      description:
        'Американский детский телевизионный мультсериал, созданный телевизионным подразделением компании «Дисней».',
      image: 'assets/1/4.png',
      audio: 'assets/1/4.mp3',
    },
    {
      name: 'Черепашки ниндзя',
      description:
        'Американский мультсериал совместного производства студии Murakami-Wolf-Swenson и французской компании IDDH.',
      image: 'assets/1/5.png',
      audio: 'assets/1/5.mp3',
    },
    {
      name: 'Чип и Дейл',
      description:
        'Американский приключенческий анимационный сериал, созданный студией Walt Disney Television Animation.',
      image: 'assets/1/6.png',
      audio: 'assets/1/6.mp3',
    },
  ],
  [
    {
      name: 'Бумажный дом',
      description:
        'Испанский криминальный, драматический телесериал об ограблении, созданный Алексом Пиной.',
      image: 'assets/2/1.png',
      audio: 'assets/2/1.mp3',
    },
    {
      name: 'Воронины',
      description:
        'Российский комедийный сериал, адаптация американского ситкома «Все любят Рэймонда».',
      image: 'assets/2/2.png',
      audio: 'assets/2/2.mp3',
    },
    {
      name: 'За гранью',
      description:
        'Американский научно-фантастический телесериал Дж. Дж. Абрамса, Алекса Куртцмана и Роберто Орси.',
      image: 'assets/2/3.png',
      audio: 'assets/2/3.mp3',
    },
    {
      name: 'Игра престолов',
      description:
        'Американский телесериал в жанре фэнтези, основанный на цикле романов «Песнь льда и огня» Джорджа Р. Р. Мартина.',
      image: 'assets/2/4.png',
      audio: 'assets/2/4.mp3',
    },
    {
      name: 'Мир дикого запада',
      description:
        'Американский научно-фантастический сериал-вестерн телеканала HBO, созданный супругами Джонатаном Ноланом и Лизой Джой.',
      image: 'assets/2/5.png',
      audio: 'assets/2/5.mp3',
    },
    {
      name: 'Обмани меня',
      description:
        'Американский телесериал 2009—2011 годов, премьерный показ которого состоялся на телеканале FOX 21 января 2009 года.',
      image: 'assets/2/6.png',
      audio: 'assets/2/6.mp3',
    },
  ],
  [
    {
      name: 'Аватар',
      description:
        'Американский эпический научно-фантастический фильм сценариста и режиссёра Джеймса Кэмерона.',
      image: 'assets/3/1.png',
      audio: 'assets/3/1.mp3',
    },
    {
      name: 'Гладиатор',
      description:
        'Исторический художественный фильм режиссёра Ридли Скотта, награждённый пятью премиями «Оскар».',
      image: 'assets/3/2.png',
      audio: 'assets/3/2.mp3',
    },
    {
      name: 'Звёздные войны',
      description:
        'Эпическая космическая опера, производства Lucasfilm и Bad Robot Productions, снятая Дж. Дж. Абрамсом.',
      image: 'assets/3/3.png',
      audio: 'assets/3/3.mp3',
    },
    {
      name: 'Интерстеллар',
      description:
        'Научно-фантастический фильм, снятый Кристофером Ноланом по сценарию, написанному Джонатаном Ноланом.',
      image: 'assets/3/4.png',
      audio: 'assets/3/4.mp3',
    },
    {
      name: 'Пираты Карибского моря',
      description:
        'Серия приключенческих фильмов о пиратах в Карибском море, режиссёры Гор Вербински, Роб Маршалл, Эспен Сандберг и Юаким Рённинг.',
      image: 'assets/3/5.png',
      audio: 'assets/3/5.mp3',
    },
    {
      name: 'Терминатор 2',
      description:
        'Американский научно-фантастический боевик режиссёра Джеймса Кэмерона.',
      image: 'assets/3/6.png',
      audio: 'assets/3/6.mp3',
    },
  ],
  [
    {
      name: 'В мире животных',
      description:
        'Советская и российская просветительская телепередача о жизни животных в их естественной среде обитания.',
      image: 'assets/4/1.png',
      audio: 'assets/4/1.mp3',
    },
    {
      name: 'Жить здорово!',
      description:
        'Российская телепередача, выходящая на «Первом канале». Главная ведущая и руководитель передачи — Елена Малышева.',
      image: 'assets/4/2.png',
      audio: 'assets/4/2.mp3',
    },
    {
      name: 'КВН',
      description:
        'Телевизионные юмористические игры, в которых команды различных коллективов соревнуются между собой.',
      image: 'assets/4/3.png',
      audio: 'assets/4/3.mp3',
    },
    {
      name: 'Поле чудес',
      description:
        'Советская и российская телеигра, являющаяся частичным аналогом американской телевизионной программы «Колесо Фортуны».',
      image: 'assets/4/4.png',
      audio: 'assets/4/4.mp3',
    },
    {
      name: 'Спокойной ночи, малыши',
      description:
        'Советская и российская вечерняя телепередача для детей дошкольного и младшего школьного возраста.',
      image: 'assets/4/5.png',
      audio: 'assets/4/5.mp3',
    },
    {
      name: 'Что? Где? Когда?',
      description:
        'Советская и российская интеллектуальная телевизионная игра, телевизионный интеллектуальный клуб «знатоков».',
      image: 'assets/4/6.png',
      audio: 'assets/4/6.mp3',
    },
  ],
  [
    {
      name: 'Гардемарины, вперёд',
      description:
        'Четырёхсерийный телефильм, о российских гардемаринах XVIII века по роману Нины Соротокиной «Трое из Навигацкой школы».',
      image: 'assets/5/1.png',
      audio: 'assets/5/1.mp3',
    },
    {
      name: 'Чародеи',
      description:
        'Советская новогодняя музыкально-комедийная киносказка режиссёра Константина Бромберга по сценарию братьев Стругацких.',
      image: 'assets/5/2.png',
      audio: 'assets/5/2.mp3',
    },
    {
      name: 'Кавказская пленница',
      description: 'Советский художественный фильм, снятый Леонидом Гайдаем.',
      image: 'assets/5/3.png',
      audio: 'assets/5/3.mp3',
    },
    {
      name: 'Карнавал',
      description:
        'Советский художественный фильм, снятый в 1981 году режиссёром Татьяной Лиозновой на Киностудии имени М. Горького.',
      image: 'assets/5/4.png',
      audio: 'assets/5/4.mp3',
    },
    {
      name: 'Служебный роман',
      description:
        'Советский двухсерийный художественный фильм, лирическая трагикомедия режиссёра Эльдара Рязанова.',
      image: 'assets/5/5.png',
      audio: 'assets/5/5.mp3',
    },
    {
      name: 'Игрушка',
      description:
        'Французский художественный фильм, комедия режиссёра Франсиса Вебера, снятая в 1976 году.',
      image: 'assets/5/6.png',
      audio: 'assets/5/6.mp3',
    },
  ],
  [
    {
      name: 'Дом-2',
      description:
        'Российское реалити-шоу, является продолжением выходившего ранее шоу «Дом».',
      image: 'assets/6/1.png',
      audio: 'assets/6/1.mp3',
    },
    {
      name: 'Интуиция',
      description:
        'Российская версия известной телеигры Identity («Личность»).',
      image: 'assets/6/2.png',
      audio: 'assets/6/2.mp3',
    },
    {
      name: 'Камеди баттл',
      description:
        'Российское юмористическое шоу производства компании «Comedy Club Production».',
      image: 'assets/6/3.png',
      audio: 'assets/6/3.mp3',
    },
    {
      name: 'Однажды в России',
      description:
        'Российское юмористическое телевизионное шоу производства компании «Comedy Club Production».',
      image: 'assets/6/4.png',
      audio: 'assets/6/4.mp3',
    },
    {
      name: 'Окна',
      description:
        'Скандальное телевизионное шоу, которое транслировал канал ТНТ с 2002 по 2005 год.',
      image: 'assets/6/5.png',
      audio: 'assets/6/5.mp3',
    },
    {
      name: 'Уральские пельмени',
      description:
        'Российское творческое объединение из Екатеринбурга, работающее в комедийном жанре.',
      image: 'assets/6/6.png',
      audio: 'assets/6/6.mp3',
    },
  ],
]

let audioWin = new Audio('assets/1.mp3')
let audio = new Audio('assets/2.mp3')
const quizButton = document.querySelector('.quiz_button')
const quizButtonName = document.querySelector('.quiz_button_name')
let quizQuestionButton = document.querySelectorAll('.quiz_question_button')
const scoreButton = document.querySelector('.score_button')
const quizAnswerOption = document.querySelectorAll('.quiz_answer_option')
const quizAnswerName = document.querySelectorAll('.quiz_answer_name')
const quizAudioImg = document.querySelector('.quiz_audio_img')
const quizAudioWrapper = document.querySelector('.quiz_audio_wrapper')
const scoreTitle = document.querySelector('.score_title')
const quizAnswerKardGag = document.querySelector('.quiz_answer_kard_gag')
const quizAnswerKard = document.querySelector('.quiz_answer_kard')
const quizAnswerKardImg = document.querySelector('.quiz_answer_kard_img')
const quizAnswerKardTitle = document.querySelector('.quiz_answer_kard_title')
const quizAnswerKardTitle2 = document.querySelector('.quiz_answer_kard_title2')
let volumeMuteIcon = document.querySelector('.audio_volume_icon')
let playerVolume = document.querySelector('.audio_player_volume')
let valueNow = 0
let numberRundom = getRandomInRange(0, 5) //рандомное число правильного ответа
let clickButton = 1 //текущая стадия игры
let isGreen = false //флаг наличия правильного ответа на поле
let playPauseIcon = document.querySelector('.audio_play_icon')
let progress = document.querySelector('.audio_player_progress')
let sounds = new Audio()
let sounds2 = new Audio()
let answerPlayPauseIcon = document.querySelector('.quiz_answer_play_icon')
let answerProgress = document.querySelector('.quiz_answer_audio_input')
const blink = document.querySelector('.blink')
const startGame = document.querySelector('.start')
const mainWrapper = document.querySelector('.main_wrapper')
const quizWrapper = document.querySelector('.quiz_wrapper')
const scoreWrapper = document.querySelector('.score_wrapper')
let arrElem = [mainWrapper, scoreWrapper, quizWrapper]
let headerScoreValue = document.querySelector('.header_score_value')
let scoreValue = document.querySelector('.score_value')
let newCounter = 5

//.........................................................рандом................................................

function getRandomInRange(min, max) {
  //функция создает рандомное число
  return Math.floor(Math.random() * (max - min + 1)) + min
}

//......................................................игровое поле...............................

function textQuizAnswer() {
  //вешаем текста на кнопки ответов
  for (let i = 0; i < quizAnswerName.length; i++) {
    quizAnswerName[i].textContent = fillingGame[clickButton - 1][i].name
  }
}

for (let i = 0; i < quizAnswerOption.length; i++) {
  //перебираем кнопки ответов и навешиваем стиль на рандомную правильную
  quizAnswerOption[i].addEventListener('click', function () {
    if (isGreen === true) {
      //если правильная кнопка УЖЕ найдена
      openOtherElements(i)
      quizButton.style.backgroundImage = 'url("assets/6.png")'
      quizButtonName.style.color = '#000'
      sounds.pause()
      sounds2.pause()
      nowSounds2(i)
      playPauseIcon.classList.remove('audio_pause_icon')
      playPauseIcon.classList.add('audio_play_icon')
      setTimeout(resetProgress, 100)
      answerPlayPauseIcon.classList.remove('quiz_answer_pause_icon')
      answerPlayPauseIcon.classList.add('quiz_answer_play_icon')
      setTimeout(resetAnswerProgress, 100)
    } else {
      //если правильная кнопка ещё НЕ найдена
      if (i === numberRundom) {
        //кнопку нашли
        quizAnswerOption[i].style.backgroundColor = '#138701'
        quizButton.style.backgroundImage = 'url("assets/6.png")'
        quizButtonName.style.color = '#000'
        isGreen = true
        openElements(i)
        openOtherElements(i)
        audio.currentTime = 0
        audioWin.play()
        sounds.pause()
        sounds2.pause()
        playPauseIcon.classList.remove('audio_pause_icon')
        playPauseIcon.classList.add('audio_play_icon')
        setTimeout(resetProgress, 100)
        answerPlayPauseIcon.classList.remove('quiz_answer_pause_icon')
        answerPlayPauseIcon.classList.add('quiz_answer_play_icon')
        setTimeout(resetAnswerProgress, 100)
        headerScoreValue.textContent = (
          +headerScoreValue.textContent + newCounter
        ).toString()
        newCounter = 5
      } else {
        //кнопку не нашли
        quizAnswerOption[i].style.backgroundColor = '#cd0706'
        quizButton.style.backgroundImage = 'url("assets/9.png")'
        quizButtonName.style.color = '#c2c9d2'
        audio.currentTime = 0
        audio.play()
        newCounter--
      }
    }
  })
}

quizButton.addEventListener('click', function () {
  //клик по кнопке следующего вопроса
  if (isGreen === true) {
    if (quizButtonName.textContent === 'следующий вопрос') {
      for (let i = 0; i < quizQuestionButton.length; i++) {
        //всем сбрасываем заливку на начальную
        quizQuestionButton[i].style.backgroundColor = '#3fd6ff'
      }
      for (let i = 0; i < quizAnswerOption.length; i++) {
        //всем сбрасываем заливку на начальную
        quizAnswerOption[i].style.backgroundColor = '#3fd6ff'
      }
      //красим в желтый текущую кнопку
      quizQuestionButton[clickButton].style.backgroundColor = '#feb900'
      clickButton++
      textQuizAnswer()
      numberRundom = getRandomInRange(0, 5)
      sounds.pause()
      sounds2.pause()
      playPauseIcon.classList.remove('audio_pause_icon')
      playPauseIcon.classList.add('audio_play_icon')
      setTimeout(resetProgress, 100)
      answerPlayPauseIcon.classList.remove('quiz_answer_pause_icon')
      answerPlayPauseIcon.classList.add('quiz_answer_play_icon')
      setTimeout(resetAnswerProgress, 100)
      nowSounds(numberRundom)
      nowSounds2(numberRundom)
      quizAudioImg.style.backgroundImage = 'url("assets/7.png")'
      scoreTitle.textContent = '**********'
      quizAnswerKardGag.style.display = 'flex'
      quizAnswerKard.style.display = 'none'
      quizAnswerKardTitle.textContent = ''
      quizAnswerKardTitle2.textContent = ''
      quizButton.style.backgroundImage = 'url("assets/9.png")'
      quizButtonName.style.color = '#c2c9d2'
      isGreen = false
      if (clickButton === 6) {
        quizButtonName.textContent = 'завершить игру'
      }
    } else {
      //переход на страницу с результатами
      qwerty(scoreWrapper)
      scoreValue.textContent = headerScoreValue.textContent
      if (scoreValue.textContent === '30') {
        scoreButton.textContent = 'завершить'
      }
    }
  }
})

scoreButton.addEventListener('click', function () {
  //клик по кнопке переиграть
  if (scoreValue.textContent === '30') {
    blink.click()
  } else {
    startGame.click()
    headerScoreValue.textContent = 0
  }
})

function openElements(i) {
  //открываем все скрытые элементы при правильном ответе
  quizAudioImg.style.backgroundImage = `url("${
    fillingGame[clickButton - 1][i].image
  }")`
  scoreTitle.textContent = `${fillingGame[clickButton - 1][i].name}`
}

function openOtherElements(i) {
  //открываем все скрытые элементы если правильный УЖЕ выбран
  quizAnswerKardGag.style.display = 'none'
  quizAnswerKard.style.display = 'flex'
  quizAnswerKardImg.style.backgroundImage = `url("${
    fillingGame[clickButton - 1][i].image
  }")`
  quizAnswerKardTitle.textContent = `${fillingGame[clickButton - 1][i].name}`
  quizAnswerKardTitle2.textContent = `${
    fillingGame[clickButton - 1][i].description
  }`
}

//.................................................звук аудиоплеера.................................................//

volumeMuteIcon.addEventListener('click', function () {
  //вкл/выкл звука
  volumeMuteIcon.classList.toggle('audio_mute_icon')
  volumeMuteIcon.classList.toggle('audio_volume_icon')
  if (volumeMuteIcon.classList.contains('audio_mute_icon')) {
    //если звук выключен, сбрасываем стили ползунка в ноль
    valueNow = playerVolume.value
    sounds.volume = 0
    playerVolume.value = 0
    playerVolume.style.background = `linear-gradient(to right, #feb900 0%, #feb900 0%, #a1aab3 0%, #a1aab3 100%)`
  } else {
    //если звук включен, берем значение из валуе ползунка и красим ползунок до этого уровня
    playerVolume.value = valueNow
    sounds.volume = valueNow / 100
    playerVolume.style.background = `linear-gradient(to right, #feb900 0%, #feb900 ${valueNow}%, #a1aab3 ${valueNow}%, #a1aab3 100%)`
    valueNow = 0
  }
})

playerVolume.addEventListener('input', function () {
  //перетягивание ползунка мышкой
  if (volumeMuteIcon.classList.contains('audio_mute_icon')) {
    volumeMuteIcon.classList.remove('audio_mute_icon')
    volumeMuteIcon.classList.add('audio_volume_icon')
  }
  let valueClick = this.value
  this.style.background = `linear-gradient(to right, #feb900 0%, #feb900 ${valueClick}%, #a1aab3 ${valueClick}%, #a1aab3 100%)`
  sounds.volume = valueClick / 100
  if (valueClick === '0') {
    volumeMuteIcon.classList.remove('audio_volume_icon')
    volumeMuteIcon.classList.add('audio_mute_icon')
  }
})

//.................................................аудиоплеер.................................................//

function nowSounds(i) {
  //создаем новое аудио
  let newSoundsVolume = sounds.volume
  sounds = new Audio(fillingGame[clickButton - 1][i].audio)
  sounds.volume = newSoundsVolume
  sounds.addEventListener('timeupdate', function () {
    //цвет ползунка при проигрывании музыки
    progress.value = (sounds.currentTime * 100) / sounds.duration
    let valueClick3 = progress.value
    progress.style.background = `linear-gradient(to right, #feb900 0%, #feb900 ${valueClick3}%, #a1aab3 ${valueClick3}%, #a1aab3 100%)`
  })
  sounds.addEventListener('ended', function () {
    //стили ползунка при окончании музыки
    playPauseIcon.classList.remove('audio_pause_icon')
    playPauseIcon.classList.add('audio_play_icon')
    resetProgress()
  })
}

playPauseIcon.addEventListener('click', function () {
  //клик по иконке плей/пауза
  playPauseIcon.classList.toggle('audio_pause_icon')
  sounds2.pause()
  sounds.play()
  answerPlayPauseIcon.classList.remove('quiz_answer_pause_icon')
  answerPlayPauseIcon.classList.add('quiz_answer_play_icon')
  setTimeout(resetAnswerProgress, 100)
  if (playPauseIcon.classList.contains('audio_pause_icon')) {
    sounds.play()
  } else {
    sounds.pause()
  }
})

progress.addEventListener('input', function () {
  //цвет ползунка при перетягивании мышкой
  let valueClick2 = this.value
  sounds.currentTime = (sounds.duration / 100) * valueClick2
  this.style.background = `linear-gradient(to right, #feb900 0%, #feb900 ${valueClick2}%, #a1aab3 ${valueClick2}%, #a1aab3 100%)`
})

function resetProgress() {
  //сброс цвета ползунка при остановке музыки
  sounds.currentTime = 0
  progress.style.background = `linear-gradient(to right, #feb900 0%, #feb900 0%, #a1aab3 0%, #a1aab3 100%)`
}

//.................................................аудиоплеер в описании.................................................//

function nowSounds2(i) {
  //создаем новое аудио
  sounds2 = new Audio(fillingGame[clickButton - 1][i].audio)
  sounds2.addEventListener('timeupdate', function () {
    //цвет ползунка при проигрывании музыки
    answerProgress.value = (sounds2.currentTime * 100) / sounds2.duration
    let valueClick3 = answerProgress.value
    answerProgress.style.background = `linear-gradient(to right, #feb900 0%, #feb900 ${valueClick3}%, #a1aab3 ${valueClick3}%, #a1aab3 100%)`
  })
  sounds2.addEventListener('ended', function () {
    //стили ползунка при окончании музыки
    answerPlayPauseIcon.classList.remove('quiz_answer_pause_icon')
    answerPlayPauseIcon.classList.add('quiz_answer_play_icon')
    answerProgress.style.background = `linear-gradient(to right, #feb900 0%, #feb900 0%, #a1aab3 0%, #a1aab3 100%)`
  })
}

answerPlayPauseIcon.addEventListener('click', function () {
  //клик по иконке плей/пауза
  answerPlayPauseIcon.classList.toggle('quiz_answer_pause_icon')
  sounds.pause()
  sounds2.play()
  playPauseIcon.classList.remove('audio_pause_icon')
  playPauseIcon.classList.add('audio_play_icon')
  setTimeout(resetProgress, 100)
  if (answerPlayPauseIcon.classList.contains('quiz_answer_pause_icon')) {
    sounds2.play()
  } else {
    sounds2.pause()
  }
})

answerProgress.addEventListener('input', function () {
  //цвет ползунка при перетягивании мышкой
  let valueClick3 = this.value
  sounds2.currentTime = (sounds2.duration / 100) * valueClick3
  this.style.background = `linear-gradient(to right, #feb900 0%, #feb900 ${valueClick3}%, #a1aab3 ${valueClick3}%, #a1aab3 100%)`
})

function resetAnswerProgress() {
  //сброс цвета ползунка при остановке музыки
  sounds2.currentTime = 0
  answerProgress.style.background = `linear-gradient(to right, #feb900 0%, #feb900 0%, #a1aab3 0%, #a1aab3 100%)`
}

//......................................................начальные клики игры...............................

function resetGame() {
  //сброс игры на умолчание
  for (let i = 0; i < quizQuestionButton.length; i++) {
    quizQuestionButton[i].style.backgroundColor = '#3fd6ff'
  }
  for (let i = 0; i < quizAnswerOption.length; i++) {
    quizAnswerOption[i].style.backgroundColor = '#3fd6ff'
  }
  quizQuestionButton[0].style.backgroundColor = '#feb900'
  quizButtonName.textContent = 'следующий вопрос'
  clickButton = 1
  quizAudioImg.style.backgroundImage = 'url("assets/7.png")'
  scoreTitle.textContent = '**********'
  quizAnswerKardGag.style.display = 'flex'
  quizAnswerKard.style.display = 'none'
  quizAnswerKardTitle.textContent = ''
  quizAnswerKardTitle2.textContent = ''
  isGreen = false
  headerScoreValue.textContent = 0
}

startGame.addEventListener('click', function () {
  //клик по кнопке начать
  qwerty(quizWrapper)
  quizButton.style.backgroundImage = 'url("assets/9.png")'
  quizButtonName.style.color = '#c2c9d2'
  resetGame()
  textQuizAnswer()
  nowSounds(numberRundom)
  nowSounds2(numberRundom)
})

blink.addEventListener('click', function () {
  //клик по логотипу
  qwerty(mainWrapper)
  resetGame()
  if (sounds) {
    sounds.pause()
  }
  if (sounds2) {
    sounds2.pause()
  }
  playPauseIcon.classList.remove('audio_pause_icon')
  playPauseIcon.classList.add('audio_play_icon')
  setTimeout(resetProgress, 100)
  answerPlayPauseIcon.classList.remove('quiz_answer_pause_icon')
  answerPlayPauseIcon.classList.add('quiz_answer_play_icon')
  setTimeout(resetAnswerProgress, 100)
  headerScoreValue.textContent = 0
})

function qwerty(...args) {
  //навешиваем всем нужным элементам none и нужному элементу flex
  for (let el of arrElem) el.style.display = 'none'
  for (let el of args) el.style.display = 'flex'
}
